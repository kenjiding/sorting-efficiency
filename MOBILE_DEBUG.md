# 手机调试指南

## 准备工作

1. **确保手机和电脑连接在同一WiFi网络**
2. **确保防火墙允许端口访问**（6789和7890）

## 步骤

### 1. 获取电脑的IP地址

**macOS/Linux:**
```bash
ifconfig | grep "inet " | grep -v 127.0.0.1
```

**Windows:**
```bash
ipconfig
```
查找 "IPv4 地址"，通常是 `192.168.x.x` 或 `10.0.x.x` 格式

### 2. 启动开发服务器

在项目根目录运行：
```bash
npm run start:all
```

或者分别启动：
```bash
# 终端1：启动后端服务器
npm run server:dev

# 终端2：启动前端开发服务器
npm run dev
```

### 3. 在手机上访问

启动后，终端会显示：
- 前端地址：`http://你的IP:6789`
- 后端API：`http://你的IP:7890`

**示例：**
如果电脑IP是 `192.168.1.100`，则在手机浏览器访问：
```
http://192.168.1.100:6789/scan
```

### 4. 配置API地址（重要！）

如果手机无法连接API，需要设置环境变量：

创建 `.env.local` 文件（如果不存在）：
```env
VITE_API_URL=http://你的IP:7890/api
```

例如：
```env
VITE_API_URL=http://192.168.1.100:7890/api
```

然后重启前端服务器。

## 常见问题

### 问题1：手机无法访问
- ✅ 检查手机和电脑是否在同一WiFi
- ✅ 检查防火墙是否阻止了端口
- ✅ 尝试关闭电脑的VPN（如果有）

### 问题2：API请求失败
- ✅ 检查 `.env.local` 中的API地址是否正确
- ✅ 确保后端服务器正在运行
- ✅ 在手机浏览器访问 `http://你的IP:7890/health` 测试后端连接

### 问题3：摄像头权限
- ✅ 确保手机浏览器允许摄像头权限
- ✅ iOS Safari需要HTTPS才能使用摄像头（开发环境可能需要使用Chrome或Firefox）

### 问题4：扫描功能不工作
- ✅ 确保使用HTTPS或localhost（某些浏览器要求）
- ✅ 尝试使用Chrome或Firefox浏览器
- ✅ 检查浏览器控制台是否有错误

## 快速启动脚本

运行以下命令可以自动获取IP并启动：
```bash
./start-mobile.sh
```

（如果脚本不存在，可以手动按照上述步骤操作）

